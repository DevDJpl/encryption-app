import{r as d,j as s}from"./index-D6DwXC66.js";import{f as U}from"./index-KyQ-B_lz.js";const B=()=>{const[h,N]=d.useState(""),[o,u]=d.useState(null),[f,c]=d.useState(null),[p,x]=d.useState(!1),C=e=>e.replace(/^https?:\/\//,"").trim(),E=e=>{try{const l=e.replace(/^[\s\S]*?-----BEGIN CERTIFICATE-----/s,"-----BEGIN CERTIFICATE-----").split("-----END CERTIFICATE-----").filter(t=>t.trim()!=="").map(t=>t.trim()+`
-----END CERTIFICATE-----`).map(t=>t.replace(/^[\s\S]*?-----BEGIN CERTIFICATE-----/s,"-----BEGIN CERTIFICATE-----")).map((t,n)=>{try{const r=U.pki.certificateFromPem(t),a=r.publicKey;if(!a||!("n"in a&&"e"in a))throw new Error(`Unsupported key algorithm at index ${n}`);return r}catch(r){return console.warn(`Skipping certificate at index ${n}:`,r.message),null}}).filter(t=>t!==null).slice(0,12).map(t=>{var g,b,_,j,v;const n=new Date().getTime(),r=new Date(t.validity.notBefore).getTime(),a=new Date(t.validity.notAfter).getTime(),T=Math.floor((a-r)/(1e3*60*60*24)),S=Math.floor((a-n)/(1e3*60*60*24)),F=n>=r&&n<=a,R={"1.2.840.113549.1.1.5":"sha1WithRSAEncryption","1.2.840.113549.1.1.11":"sha256WithRSAEncryption","1.2.840.113549.1.1.12":"sha384WithRSAEncryption","1.2.840.113549.1.1.13":"sha512WithRSAEncryption"},m=t.getExtension("subjectAltName"),D=m&&Array.isArray(m.value)?m.value.map(y=>y.dnsName||y.ipAddress).join(", "):"No SANs available";return{issued_to:((g=t.subject.attributes[3])==null?void 0:g.value)||null,issuer_c:((b=t.issuer.attributes[0])==null?void 0:b.value)||null,issuer_o:((_=t.issuer.attributes[1])==null?void 0:_.value)||null,issuer_ou:((j=t.issuer.attributes[2])==null?void 0:j.value)||null,issuer_cn:((v=t.issuer.attributes[3])==null?void 0:v.value)||null,cert_sn:t.serialNumber,cert_sha1:"",cert_alg:R[t.siginfo.algorithmOid]||"Unknown Algorithm",cert_ver:t.version,cert_sans:D,cert_exp:t.validity.notAfter,cert_valid:F,validFrom:t.validity.notBefore.toISOString(),validTo:t.validity.notAfter.toISOString(),validityDays:T,daysLeft:S}});u({certificates:l}),c(null)}catch{c("Invalid certificate format.")}},w=e=>{u({certificates:[{host:e.host,resolved_ip:e.resolved_ip,issued_to:e.issued_to,issuer_c:e.issuer_c,issuer_o:e.issuer_o,issuer_ou:e.issuer_ou,issuer_cn:e.issuer_cn,cert_sn:e.cert_sn,cert_sha1:e.cert_sha1,cert_alg:e.cert_alg,cert_ver:e.cert_ver,cert_sans:e.cert_sans,cert_exp:e.cert_exp,cert_valid:e.cert_valid,validFrom:e.valid_from,validTo:e.valid_till,validityDays:e.validity_days,daysLeft:e.days_left,hstsHeaderEnabled:e.hsts_header_enabled}]}),c(null)},A=e=>{var l;const i=(l=e.target.files)==null?void 0:l[0];if(i){const t=new FileReader;t.onload=()=>{typeof t.result=="string"&&E(t.result)},t.readAsText(i)}},I=async()=>{x(!0);try{const i=await fetch(`https://api.allorigins.win/raw?url=https://ssl-checker.io/api/v1/check/${C(h)}`);if(!i.ok)throw new Error("Failed to fetch the certificate.");const l=await i.json();w(l.result)}catch{c("Failed to fetch or parse the certificate from the provided URL.")}finally{x(!1)}};return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"bg-[#1e2d4b] p-8 rounded-lg shadow-md max-w-md w-full",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Certificate Viewer"}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Upload Certificate"}),s.jsx("input",{type:"file",accept:".crt,.pem",onChange:A,className:"w-full p-3 bg-[#1c2537] border border-none rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-[#2196f3] file:mr-4 file:py-2 file:px-4 file:rounded-l-md file:border-0 file:text-sm file:bg-[#2196f3] file:text-blue-700 hover:file:bg-blue-100"})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Fetch SSL Certificate from URL"}),s.jsx("input",{type:"text",placeholder:"www.example.com",value:h,onChange:e=>N(e.target.value),className:"w-full p-3 bg-[#1c2537] border border-none rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-[#2196f3]"}),s.jsx("button",{onClick:I,className:"w-full bg-[#2196f3] text-white p-3 rounded-lg hover:bg-[#2196f3]/80 transition-colors",disabled:p,children:p?"Fetching...":"Fetch"})]}),f&&s.jsx("div",{className:"mb-6 p-4 text-red-700 bg-red-100 rounded-lg",children:f}),(o==null?void 0:o.certificates)&&s.jsxs("div",{className:"mt-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Certificate Chain Details"}),o.certificates.map((e,i)=>s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border mb-4",children:[s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Host:"})," ",e.host]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Resolved IP:"})," ",e.resolved_ip]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Issued To:"})," ",e.issued_to]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Issuer Country:"})," ",e.issuer_c]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Issuer Organization:"})," ",e.issuer_o]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Issuer Common Name:"})," ",e.issuer_cn]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Certificate Serial Number:"})," ",e.cert_sn]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"SHA1 Fingerprint:"})," ",e.cert_sha1]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Certificate Algorithm:"})," ",e.cert_alg]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Certificate Version:"})," ",e.cert_ver]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Certificate SANs:"})," ",e.cert_sans]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Valid From:"})," ",e.validFrom]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Valid To:"})," ",e.validTo]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Validity Days:"})," ",e.validityDays]}),s.jsxs("p",{className:"mb-2",children:[s.jsx("strong",{children:"Days Left:"})," ",e.daysLeft]}),s.jsxs("p",{children:[s.jsx("strong",{children:"HSTS Header Enabled:"})," ",e.hstsHeaderEnabled?"Yes":"No"]})]},i))]})]})})};export{B as default};
